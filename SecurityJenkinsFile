pipeline {
    agent {
        docker {
            image 'maven:3-alpine'
            args '-v /root/.m2:/root/.m2'
        }
    }
    stages {
       stage('Git Checkout') {
                 steps {
                     script {
                        currentBuild.result = "SUCCESS"
                     }
                     checkout([
                         $class: 'GitSCM',

                         branches: [[name: 'zapsecurity']],

                         userRemoteConfigs: [[credentialsId: 'krimohshu_2fa',
                         url: 'https://github.com/genomicsengland/ngis_ui_auto_tests.git']]
                     ])
                     sh ('git config --global user.email "krishan.shukla@optum.com"')
                     sh ('git config --global user.name "Sandbox Jenkins"')
                     sh ('git config --global push.default simple')
                 }
             }
        stage('Build') {
            steps {
                sh 'mvn -B clean test -DTestEnvironment=integration'
            }
        }
    }
}